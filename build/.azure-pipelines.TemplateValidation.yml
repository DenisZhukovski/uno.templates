jobs:
- job: Packages_Validation

  pool:
    vmImage: 'windows-2022'

  strategy:
    matrix:
      DefaultArguments:
        templateArgs: ''
      Recommended:
        templateArgs: '-preset recommended'
      SkiaOnlyHeads:
        templateArgs: '-platforms gtk wpf linux-fb'
      MobileOnlyHeads:
        templateArgs: '-platforms android ios maccatalyst'
      RecommendedMarkup:
        templateArgs: '-preset recommended -markup csharp'
      RecommendNoCpm:
        templateArgs: '-preset recommended --cpm false'
      MVVM:
        templateArgs: '-preset recommended -presentation mvvm'
      NoCentralPackageManagement:
        templateArgs: '--cpm false'
      CSharpMarkup:
        templateArgs: '-markup csharp'
      NoHosting:
        templateArgs: '-preset recommended -di false'
      HostingOnly:
        templateArgs: '-preset recommended -config false -loc false -http false -log none --navigation blank'
      NoConfiguration:
        templateArgs: '-preset recommended -config false'
      NoLocalization:
        templateArgs: '-preset recommended -loc false'
      NoHttp:
        templateArgs: '-preset recommended -http false'
      NoSerilog:
        templateArgs: '-preset recommended -log default'
      NoServer:
        templateArgs: '-preset recommended -server false'
      NoServerNoHttp:
        templateArgs: '-preset recommended -server false -http false'
      NoTests:
        templateArgs: '-preset recommended -tests none'
      FrameNavigation:
        templateArgs: '-preset recommended --navigation blank'
      # net8 is the default for tfm, so validating net7.0
      Net7:
        templateArgs: '-preset recommended -tfm net7.0'
      # https://github.com/unoplatform/uno.templates/issues/22
      Issue22:
        templateArgs: '-preset blank -tfm net7.0 -platforms android -platforms ios -platforms maccatalyst -platforms macos -platforms windows -platforms wasm -platforms gtk -platforms wpf -platforms linux-fb -presentation mvvm -server false -tests none -vscode false -pwa false -di true -nav regions -log none -theme material'
      CustomAuthMvux:
        templateArgs: '-preset=recommended -auth=custom'
      CustomAuthMvvm:
        templateArgs: '-preset=recommended -presentation mvvm -auth=custom'
      WebAuthMvux:
        templateArgs: '-preset=recommended -auth=web'
      WebAuthMvvm:
        templateArgs: '-preset=recommended -presentation mvvm -auth=web'
      OidcAuthMvux:
        templateArgs: '-preset=recommended -auth=oidc'
      OidcAuthMvvm:
        templateArgs: '-preset=recommended -presentation mvvm -auth=oidc'
      MsalAuthMvux:
        templateArgs: '-preset=recommended -auth=msal'
      MsalAuthMvvm:
        templateArgs: '-preset=recommended -presentation mvvm -auth=msal'
      MauiBlank:
       templateArgs: '-preset=blank -maui'
      MauiRecommended:
       templateArgs: '-preset=recommended -maui'
      ThemeService:
       templateArgs: '-theme-service'
      # https://github.com/unoplatform/uno.templates/issues/396
      Issue396:
       templateArgs: '-preset blank -platforms windows -platforms android -presentation none -theme fluent -nav blank -log none -maui -markup csharp'
      # https://github.com/unoplatform/uno.templates/issues/414
      Issue414:
       templateArgs: '-preset recommended -auth msal -markup csharp'
      # https://github.com/unoplatform/uno.templates/issues/477
      Issue477:
       templateArgs: '-preset recommended -theme material -toolkit'
      # https://github.com/unoplatform/uno.templates/issues/500
      Issue500:
       templateArgs: '-preset blank -tfm net8.0 -markup csharp -presentation mvux -theme material -di -config -http -nav regions -log default -server -auth msal'

  variables:
    - name: UseDotNetNativeToolchain
      value: false

  steps:
  - template: templates/package-validation.yml
    parameters:
      arguments: $(templateArgs)
